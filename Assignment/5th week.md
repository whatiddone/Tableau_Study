# Fifth Study Week

- 39강: [LOD](#39강-lod)

- 40강: [EXCLUDE](#40-lod-exclude)

- 41강: [INCLUDE](#41-lod-include)

- 42강 : [매개변수](#42-매개변수)

- 43강 : [매개변수 실습](#43-매개변수-실습) 
![링크](https://youtu.be/GJvB8hBqeE8?si=3jIj1iymZHZ7mBam)

- 44강: [매개변수 실습](#44-매개변수-실습)

- 45강: [마크카드](#45-워크시트-마크카드)

- 46강: [서식계층](#46-서식-계층)

- 47강: [워크시트](#47-워크시트-서식)

- [문제1](#문제-1)

- [문제2](#문제-2)

## Study Schedule

| 강의 범위     | 강의 이수 여부 | 링크                                                                                                        |
|--------------|---------|-----------------------------------------------------------------------------------------------------------|
| 1~9강        |  ✅      | [링크](https://www.youtube.com/watch?v=AXkaUrJs-Ko&list=PL87tgIIryGsa5vdz6MsaOEF8PK-YqK3fz&index=84)       |
| 10~19강      | ✅      | [링크](https://www.youtube.com/watch?v=AXkaUrJs-Ko&list=PL87tgIIryGsa5vdz6MsaOEF8PK-YqK3fz&index=75)       |
| 20~29강      | ✅      | [링크](https://www.youtube.com/watch?v=AXkaUrJs-Ko&list=PL87tgIIryGsa5vdz6MsaOEF8PK-YqK3fz&index=65)       |
| 30~38강      | ✅      | [링크](https://www.youtube.com/watch?v=e6J0Ljd6h44&list=PL87tgIIryGsa5vdz6MsaOEF8PK-YqK3fz&index=55)       |
| 39~47강      | ✅      | [링크](https://www.youtube.com/watch?v=AXkaUrJs-Ko&list=PL87tgIIryGsa5vdz6MsaOEF8PK-YqK3fz&index=45)       |
| 48~59강      | 🍽️      | [링크](https://www.youtube.com/watch?v=AXkaUrJs-Ko&list=PL87tgIIryGsa5vdz6MsaOEF8PK-YqK3fz&index=35)       |
| 60~69강      | 🍽️      | [링크](https://www.youtube.com/watch?v=AXkaUrJs-Ko&list=PL87tgIIryGsa5vdz6MsaOEF8PK-YqK3fz&index=25)       |
| 70~79강      | 🍽️      | [링크](https://www.youtube.com/watch?v=AXkaUrJs-Ko&list=PL87tgIIryGsa5vdz6MsaOEF8PK-YqK3fz&index=15)       |
| 80~89강      | 🍽️      | [링크](https://www.youtube.com/watch?v=AXkaUrJs-Ko&list=PL87tgIIryGsa5vdz6MsaOEF8PK-YqK3fz&index=5)        |


<!-- 여기까진 그대로 둬 주세요-->

> **🧞‍♀️ 오늘의 스터디는 지니와 함께합니다.**


## 39강. LOD
<!-- INCLUDE, EXCLUDE, FIXED 등 본 강의에서 알게 된 LOD 표현식에 대해 알게 된 점을 적어주세요. -->
- LOD: Level Of Detail: 뷰의 세부 수준
  - 현재 뷰에는 영향 X, 본인이 원하는 세부 수준에서 계산 수행 가능
  - 계산할 수준을 세부적으로 제어 가능하도록 함
    - 측정값에 '매출' 필드를 넣으면, 원본 데이터 매출의 총합계 표시
    - 측정값에 '매출', 행에 '지역'을 넣으면 지역이라는 세부 수준으로 매출들을 계산(지역 수준에 따라 매출 데이터를 표시)

#### FIXED LOD
- 현재 뷰에 있는 차원과 상관없이 계산된 필드에서 **원하는 차원**을 따라 계산
  - FIXED에서 설정한 차원이 뷰에 포함되어 있을 때
  
        { FIXED [지역] : SUM ([매출]) } # 지역별 매출
    ![39_1](/image/5th_week_image/39_1.png)

  - FIXED에서 설정한 차원이 뷰에 포함되어 있지 않을 때

        { FIXED [범주] : SUM ([매출]) } # 범주별 매출
    ![39_2](/image/5th_week_image/39_2.png)

실습) 제품별 매출 구성 비율(%)
- 퀵 테이블 계산 이용
  ![39_3](/image/5th_week_image/39_3.png)

  <p align="center">
  <img src="/image/5th_week_image/39_4.png" width="45%" alt="Image 1">
  <img src="/image/5th_week_image/39_5.png" width="45%" alt="Image 2">
  </p>

  ```
  현재는 선택된(뷰에서 보이는) 범주들을 대상으로 구성 비율을 계산하기 때문에, 선택하는 하위 범주들에 따라 구성 비율의 계산법이 바뀐다.
  ```
- FIXED 함수를 통해 구성 비율이 선택하는 하위 범주들에 영향을 받지 않도록 하기
  ```
  { FIXED : SUM ([매출]) } # 전체 매출
  LOD 표현식에서 차원을 입력하지 않으면 전체 데이터를 기준으로 계산  
  ```
  ```
  SUM([매출])/sum([전체 매출]) # 제품 구성 비율
  필드 우클릭 -> 기본 속성 -> 숫자 형식 -> 백분율
  ```
  <p align="center">
  <img src="/image/5th_week_image/39_6.png" width="45%" alt="Image 1">
  <img src="/image/5th_week_image/39_7.png" width="45%" alt="Image 2">
  </p>



## 40. LOD EXCLUDE

<!-- INCLUDE, EXCLUDE, FIXED 등 본 강의에서 알게 된 LOD 표현식에 대해 알게 된 점을 적고, 아래 두 질문에 답해보세요 :) -->
####  EXCLUDE LOD
- 현재 뷰에서 특정 차원을 **제외**하여 계산할 때 사용
> **🧞‍♀️ FIXED와 EXCLUDE을 사용하는 경우의 차이가 무엇인가요?**
- Fixed와 Exclude를 사용하여 각각 새로운 필드 생성
  <p align="center">
  <img src="/image/5th_week_image/40_1.png" width="45%" alt="Image 1">
  <img src="/image/5th_week_image/40_2.png" width="45%" alt="Image 2">
  </p>
1. 행 선반에 "제조업체" 수준 추가
  <p align="center">
  <img src="/image/5th_week_image/40_3.png" width="45%" alt="Image 1">
  <img src="/image/5th_week_image/40_4.png" width="45%" alt="Image 2">
  </p>
```
EXCLUDE는 "하위 범주" 차원을 무시하고 매출의 합계를 표시하긴 하지만, 현재 뷰의 "제조업체" 차원이 "하위 범주" 차원보다 세부 수준이 더 낮아서 제조업체 기준으로 관련된 매출 표시
```

2. "하위 범주" 필터에서 조건을 변경
  <p align="center">
  <img src="/image/5th_week_image/40_5.png" width="45%" alt="Image 1">
  <img src="/image/5th_week_image/40_6.png" width="45%" alt="Image 2">
  </p>
```
FIXED는 특정 차원을 사용해 계산하기 때문에 필터의 영향을 받지 않지만, EXCLUDE는 뷰에 있는 차원을 따라 계산하기 때문에 관련 차원으 필터의 영향을 받음.
```
```
FIXED: "특정 차원"을 사용해 계산하기 때문에 다른 하위 범주의 차원이나 필터의 영향을 받지 않는다.
EXCLUDE: 뷰에 있는 차원을 따라 계산하기 떄문에, 하위 범주가 생기거나 뷰에 있는 차원에 필터가 걸리면 영향을 받는다.
```

실습) 하위 범주 중 '액세서리' 매출을 기준으로 다른 하위 범주들과의 매출 차이 비교

- 액세서리 매출 계산 필드

       IF [하위 범주]= "액세서리" THEN [매출] END # 액세서리 매출
- 각 제품마다 "액세서리"의 매출 값을 표시하는 필드

      {EXCLUDE [하위 범주]:SUM([액세서리 매출])} # EXCLUDE 하위 범주 매출
- 각 제품들의 매출과 액세서리의 매출 차이를 계산하는 필드

      sum([매출])-ATTR([EXCLUDE 하위 범주 매출]) # 각 제품별 매출과 액세서리 매출의 차이

![40_7](/image/5th_week_image/40_7.png)

> **🧞‍♀️ 왜 ATTR 함수를 사용하나요?**

```
ATTR 함수는 '그룹의 모든 행에 대해 단일 값만 포함하면 주어진 식의 값을 반환하고, 그렇지 않으면 (*)를 반환한다.

특히 EXCLUDE 구문을 사용하여 얻은 결과를 ATTR로 처리하는 것은, Tableau가 각 행이나 뷰에서 단일 값으로 매핑된 EXCLUDE 하위 범주 매출을 참조할 수 있도록 해줍니다. 즉, 특정 필드의 집계 결과가 단일 값으로 보장될 때만 ATTR이 그 값을 반환할 수 있기 때문에, 여러 범주가 있는 상황에서 단일 값으로 "고정"하는 역할을 합니다.
```
```
EXCLUDE 구문을 사용해도 단일 값을 보장하지 않습니다. EXCLUDE 구문은 특정 차원을 제외하고 집계하여 원하는 수준에서 값을 계산할 수 있도록 하지만, 뷰에 따라 여러 값이 반환될 수 있습니다.

예를 들어, EXCLUDE [하위 범주]: SUM([매출])을 사용하면, 하위 범주 차원을 제외한 매출 합계가 계산됩니다. 하지만, *특정 제품에 여러 하위 범주가 존재할 경우*, 하위 범주가 여러 개로 나뉘면서 각각의 값이 개별적으로 계산될 수 있습니다. 이때 EXCLUDE 결과가 여러 값이 될 수 있는 상황이 발생하게 됩니다.

따라서, EXCLUDE 구문을 사용해 계산된 값이 뷰에서 하나의 고정된 값으로 나타나길 원할 때 ATTR을 추가로 사용하여 단일 값으로 고정하는 것입니다. ATTR을 사용함으로써 단일 값을 보장하고, 여러 값이 있을 때는 *로 처리하여 오류를 방지할 수 있습니다

이로써 EXCLUDE가 여러 값을 반환할 수 있는 상황에서도 ATTR을 통해 안전하게 단일 값으로 매핑할 수 있는 것입니다.
```

## 41. LOD INCLUDE

<!-- INCLUDE, EXCLUDE, FIXED 등 본 강의에서 알게 된 LOD 표현식에 대해 알게 된 점을 적고, 아래 두 질문에 답해보세요 :) -->
####  INCLUDE LOD
- 현재 뷰에서 특정 차원을 추가하여 계산할 떄 사용
- EXCLUDE LOD와 같이 차원 필터를 통해 해당 값을 변경할 수 있다.

![41_2](/image/5th_week_image/41_2.png)

각 도시의 고객당 평균매출을 표시하고 있지만 해당 값들을 따로 필드를 생성한 것이 아니기 때문에 값을 재사용하기 위해서 INCLUDE LOD 표현식을 사용

- 각 도시의 고객당 평균매출 구하기

      AVG({INCLUDE [주문 Id]:SUM([매출])}) # 주문 ID에 따른 평균 매출
      - 주문 ID 차원을 포함해서 합계한 매출의 평균을 반환
![41_3](/image/5th_week_image/41_3.png)

- FIXED LOD를 사용해 각 도시의 고객당 평균매출 구하기

      AVG({FIXED [주문 Id]:SUM([매출])}) # 주문 ID에 따른 평균 매출 (FIXED)
![41_4](/image/5th_week_image/41_4.png)

> **🧞‍♀️ 그렇다면 어떤 경우에 각 표현식을 사용하나요? 예시와 함께 적어보아요**

```
FIXED LOD: 차원과 측정값을 반환
INCLUDE, EXCLUDE LOD: 측정값만 반환
뷰에 표시되는 값이 차원이면, FIXED LOD 표현식만 사용 가능

반환 값이 차원 필터의 영향을 받으면 INCLUDE와 EXCLUDE LOD 표현식 사용
FIXED는 차원 필터의 영향을 받지 않음
```

## 42. 매개변수

<!-- 매개변수에 대해 알게 된 점을 적어주세요 -->
- 매개 변수
  - 고정된 상수 값이 아닌 동적인 값으로 변경하기 위해서 활용하는 기능
  - 반드시 **계산식, 필터, 참조선과 함께** 사용

- 매개 변수 만들기
  1. 필터>드롭다운 메뉴>새 매개 변수 만들기
  2. 필드 우클릭>만들기>매개 변수
  3. 데이터 패널>매개 변수 만들기 (계산된 필드 만들기 아래)

- 매출이 높은 상위 5개 하위 범주 표시하기
  1. 매개 변수 만들기

  ![42_1](/image/5th_week_image/42_1.png)

  2. 데이터 패널 아래쪽 매개 변수 생성 확인>우클릭> 매개 변수 표시 

  ![42_2](/image/5th_week_image/42_2.png)<br>

  아직 상위 5개가 보이지 않는다. **계산식, 필터, 참조선과 함께 사용하지 않았기 때문**

  3. 하위 범주 필터 편집

  ![42_3](/image/5th_week_image/42_3.png)<br>

  필터의 필드 기준을 매개 변수로 설정

  ![42_4](/image/5th_week_image/42_4.png)

  ** 매개 변수 카드에 상위 N개를 표시하면 해당 값에 따라 뷰 변경
> **🧞‍♀️ 집합에도 매개변수를 적용할 수 있나요? 시도해봅시다**
  ![42_5](/image/5th_week_image/42_5.png)
  ![42_6](/image/5th_week_image/42_6.png)


## 43. 매개변수 실습(계산식)
<!-- 영상 묶음에 포함되지 않아 찾기 어려우실까 링크를 아래에 첨부하겠습니다. 수강 후 삭제해주세요-->
- 계산식과 함께 사용
  - 차원으로 매개 변수 만들기
    1. 매개변수 만들기
      ![43_1](/image/5th_week_image/43_1.png)

    2. 함께 사용할 계산식 만들기
      ![43_2](/image/5th_week_image/43_2.png)
      ```
      매개 변수에서
      국가를 선택하면 국가/지역이
      제품 제조사를 선택하면 제조 회사가
      고객을 선택하면 고객 이름이
      세그먼트를 선택하면 세그먼트
      가 나오는 계산식
      ```
  ![43_3](/image/5th_week_image/43_3.png)
  - 매개 변수에 따른 제목 변경하기
    - 제목>삽입>매개 변수.차원 선택하기
  ![43_4](/image/5th_week_image/43_4.png)
  ![43_5](/image/5th_week_image/43_5.png)

- 측정값으로 매개 변수 만들기
  1. 매개변수 만들기
  ![43_6](/image/5th_week_image/43_6.png)


  2. 함께 사용할 계산식 만들기
  ![43_7](/image/5th_week_image/43_7.png)

  
  3. 제목 수정
  ![43_8](/image/5th_week_image/43_8.png)
  ![43_9](/image/5th_week_image/43_9.png)


  4. 단위 추가
  ![43_10](/image/5th_week_image/43_10.png)


## 44. 매개변수 실습(참조선)
- 참조선과 함께 사용
  1. 분석>참조선 클릭 후 뷰로 드래그
  ![44_1](/image/5th_week_image/44_1.png)

  2. 매개변수 만들기
  ![44_2](/image/5th_week_image/44_2.png)

  3. 참조선 생성
  ![44_3](/image/5th_week_image/44_3.png)

- 목표 매출을 달성한 국가와 달성하지 못한 국가들을 구분
  1. 계산된 필드 생성(KPI)
  ![44_4](/image/5th_week_image/44_4.png)
  
  2. 마크>색상에 생성한 필드 드래그&드롭
  ![44_5](/image/5th_week_image/44_5.png)

- 그래프에서 시작 날짜와 마지막 날짜를 선택하고 해당 날짜 범위의 매출 합계 나타내기
  1. 매개변수 생성(시작 날짜, 마지막 날짜)
  <p align="center">
  <img src="/image/5th_week_image/44_6.png" width="45%" alt="Image 1">
  <img src="/image/5th_week_image/44_7.png" width="45%" alt="Image 2">
  </p>
  2. 참조선 생성
  구간> 시작 구간: 시작 날짜, 끝 구간: 마지막 날짜, 라인: 실선

  ![44_8](/image/5th_week_image/44_8.png)

  3. 선택한 날짜 구간이 하이라이트 되어 나타남
  ![44_9](/image/5th_week_image/44_9.png)

  4. 해당 날짜 범위의 매출 합계를 그래프 제목에 나타나기
  - 계산된 필드 생성

          TOTAL(SUM(IF [주문 날짜] >= [시작 날짜] AND [주문 날짜] <= [마지막 날짜] THEN 매출 end)) # 날짜 범위의 매출 합계
  - 생성한 필드를 마크>세부정보로 드래그 & 드롭
  - 제목 수정: <매개 변수.시작 날짜>부터 <매개 변수.마지막 날짜>까지 매출 합계: <집계(날짜 범위의 매출 합계)>
  ![44_10](/image/5th_week_image/44_10.png)


<!-- 매개변수에 대해 알게 된 점을 적어주세요 -->

## 45. 워크시트 마크카드

<!-- 마크카드에 대해 알게 된 점을 적어주세요 -->
- 마크: 작업 시트 안에 있는 데이터
- 마크 카드: 마크의 서식들을 변경

- 마크 유형을 변경할 때는 드롭다운 메뉴에서 변경: 차트 유형은 그대로고 마크만 변함

- 마크>색상: 마크 색상, 투명도, 테두리 설정 가능, 후광 옵션의 경우 '맵'차트에서만 사용 가능
  - 연속형 필드는 색상 범위 범례로, 불연속형 필드는 항목별 범례로 나타냄

- 마크>크기: 각 마크의 크기를 드래그로 조절 가능
- 마크>레이블: 각 마크의 정확한 숫자 값 텍스트로 표시
  - 해당 텍스트의 폰트, 색상, 크기, 방향, 위치 변경 가능
  - 어떤 마크에 (모든, 최대/최소 등)에 텍스트를 표시할지도 설정 가능
- 세부 정보에 불연속형 필드를 사용하게 되면, 차트에서 데이터를 구분해 표시하고, 연속형 필드를 사용하면 도구 설명에 데이터가 추가된다.

![45_1](/image/5th_week_image/45_1.png)
그래프의 형태에 따라 달라지는 옵션으로, 그래프 형태를 원으로 바꾸면, <모양>으로 옵션이 바뀐다.

## 46. 서식 계층

<!-- 서식계층에 대해 알게 된 점을 적어주세요 -->

> **🧞‍♀️ 서식계층을 일반적인 것에서 구체적인 것 순서로 기입해보세요**

```
1. 워크 시트 서식
2. 행/열 서식
3. 특정 필드
4. 필드 레이블
5. 도구설명/제목/마크
```
- 워크 시트 서식을 설정하는 5가지의 서식 옵션
![46_1](/image/5th_week_image/46_1.png)

- 워크 시트 서식에서 글꼴 설정
![46_2](/image/5th_week_image/46_2.png)

- 행/열 수준에서 글꼴 설정: 워크 시트 서식을 변경해도 영향 X
![46_3](/image/5th_week_image/46_3.png)

- 특정 필드 서식 설정하기
  1. 서식 패널 상단>필드
  2. 뷰에서 마우스 우클릭>서식

- 필드 레이블 서식 설정하기
  - 뷰에서 마우스 우클릭>서식

- 마크 서식: 마크카드>텍스트

![46_4](/image/5th_week_image/46_4.png)

- 모든 서식 한 번에 지우기: "서식" 탭의 "워크시트 서식 지우기": 마크 카드에서 설정한 서식만 남고 나머지는 모두 지워진다.

![46_5](/image/5th_week_image/46_5.png)


## 47. 워크시트 서식

<!-- 워크시트 서식에 대해 알게 된 점을 적어주세요!-->
- 워크시트의 글꼴, 맞춤, 음영
![47_1](/image/5th_week_image/47_1.png)
```
머리글, 패널, 총계마다 다른 색상 적용
```
```
맞춤 서식에서 글자의 위치, 각도 조절 가능
```
```
음영 서식에는 "행/열 색상 교차"라는 설정이 존재
-> 데이터 셀의 구간을 설정해서 음영을 줄 수 있다.
# 구간 크기의 각 눈금이 하나의 데이터 셀 단위
```
![47_2](/image/5th_week_image/47_2.png)
- 구간 크기를 최대로 설정: 5개 행마다 음영 처리

## 문제 리스트

## 문제 1.

```
가장 많이 주문한 사람들은 물건 배송을 빨리 받았을까요?
조건을 준수하여 아래 이미지를 만들어봆시다.
1) 국가/지역별(이하 '나라'로 통칭), 범주별로 배송일자가 다를 수 있으니 먼저, 나라별/범주별로 평균 배송일자를 설정한 뒤,
2) 각 나라에서 가장 많이 주문한 사람의 이름을 첫 번째 열,
3) 그 사람이 주문한 제품 이름을 2번째 열,
4) 각 상품이 배송까지 걸린 날 수를 표현하고
5) 그리고 만약 배송이 각 나라/범주별 평균보다 빨랐다면 '빠름', 같다면 '평균', 느리다면 '느림' 으로 print 해주세요. 
```
```
계산된 필드 만들기: 나라별/범주별 평균 배송기간
배송 기간: DATEDIFF('day',[주문 날짜], [배송 날짜])
나라별 평균 배송기간: {FIXED [국가/지역]: AVG([배송 기간])}
범주별 평균 배송기간: {FIXED [범주]: AVG([배송 기간])}
나라별/범주별 평균 배송 기간: {FIXED [], [범주]: AVG([배송 기간])}
배송 속도 수준: IF [배송 기간] < {FIXED [국가/지역], [범주]: AVG([배송 기간])} THEN "빠름"
ELSEIF [배송 기간] = {FIXED [국가/지역], [범주]: AVG([배송 기간])} THEN "평균"
ELSE "느림"
END

# 각 나라에서 가장 많이 주문한 사람 구하기 with 지피티
1. 고객별 주문 횟수 계산: 먼저 각 고객의 주문 횟수를 계산합니다.
{FIXED [국가/지역], [고객 이름]: COUNT([주문 Id])}

2. 나라별 최대 주문 횟수 계산: 각 나라에서 가장 많이 주문한 사람을 찾기 위해 나라별 최대 주문 횟수를 계산합니다.
{FIXED [국가/지역]: MAX({FIXED [국가/지역], [고객 이름]: COUNT([주문 Id])})}

3. 최다 주문 고객 식별: 이제 각 고객의 주문 횟수가 나라별 최대 주문 횟수와 같은지 비교하여 최다 주문 고객을 식별합니다.
IF {FIXED [국가/지역], [고객 이름]: COUNT([주문 Id])} = {FIXED [국가/지역]: MAX({FIXED [국가/지역], [고객 이름]: COUNT([주문 Id])})} THEN "최다 주문 고객"
ELSE ""
END

```
![이미지주소](/image/5th_week_image/Q1.png)


<!-- 여기까지 오는 과정 중 알게 된 점을 기입하고, 결과는 시트 명을 본인 이름으로 바꾸어 표시해주세요.-->

## 문제 2.

```
채원이는 태블로를 쓰실 수 없는 상사분께 보고하기 위한 대시보드를 만들고 싶어요. 

제품 중분류별로 구분하되 매개변수로써 수익, 매출, 수량을 입력하면 저절로 각각 지표에 해당하는 그래프로 바뀌도록 설계하고자 해요.

 어떤 값이 각 지표의 평균보다 낮은 값을 갖고 있다면 색깔을 주황색으로, 그것보다 높다면 파란색으로 표시하고 싶어요. 그 평균값은 각 지표별로 달라야 해요.
```
![이미지주소](/image/5th_week_image/Q2_1.png)

```
# 매개변수로 계산된 필드 만들기
CASE [매개 변수].[대시보드]
WHEN "수익" THEN [수익]
WHEN "매출" THEN [매출]
WHEN "수량" THEN [수량]
END

# 평균 계산 필드 만들기
CASE [지표 선택]
  WHEN "수익" THEN AVG([수익])
  WHEN "매출" THEN AVG([매출])
  WHEN "수량" THEN AVG([수량])
END

# 색 바꾸기
```

# EXCLUDE랑 CASE를 잘 쓰면 될 것 같은데... 교육팀장님 도와주세요...
  ![43_7](/image/5th_week_image/43_7.png)

![example](https://github.com/yousrchive/BUSINESS-INTELLIGENCE-TABLEAU/blob/main/study/img/2nd%20study/%E1%84%83%E1%85%A1%E1%84%8B%E1%85%AE%E1%86%AB%E1%84%85%E1%85%A9%E1%84%83%E1%85%B3.png?raw=true)

<!-- 예시 사진은 지워주세요-->
