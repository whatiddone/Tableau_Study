# Fourth Study Week

- 30강: [계층](#30-계층)

- 31강: [집합](#31-집합)

- 32강: [결합집합](#32-결합집합)

- 33강: [계산된 필드](#33-계산된-필드)

- 34강: [행수준계산](#34-행수준계산)

- 35강: [집계계산](#35-집계계산)

- 36강: [테이블계산](#36-테이블계산)

- 37강: [퀵테이블계산(1)](#37-퀵테이블계산1)

- 38강: [퀵테이블계산(2)](#38-퀵테이블계산2)

- [문제1](#문제-1)

- [문제2](#문제-2)

- [문제3](#문제-3)

## Study Schedule

| 강의 범위     | 강의 이수 여부 | 링크                                                                                                        |
|--------------|---------|-----------------------------------------------------------------------------------------------------------|
| 1~9강        |  ✅      | [링크](https://www.youtube.com/watch?v=AXkaUrJs-Ko&list=PL87tgIIryGsa5vdz6MsaOEF8PK-YqK3fz&index=84)       |
| 10~19강      | ✅      | [링크](https://www.youtube.com/watch?v=AXkaUrJs-Ko&list=PL87tgIIryGsa5vdz6MsaOEF8PK-YqK3fz&index=75)       |
| 20~29강      | ✅      | [링크](https://www.youtube.com/watch?v=AXkaUrJs-Ko&list=PL87tgIIryGsa5vdz6MsaOEF8PK-YqK3fz&index=65)       |
| 30~38강      | ✅      | [링크](https://youtu.be/e6J0Ljd6h44?si=nhGbB7GsdOCqj15f)       |
| 39~49강      | 🍽️      | [링크](https://www.youtube.com/watch?v=AXkaUrJs-Ko&list=PL87tgIIryGsa5vdz6MsaOEF8PK-YqK3fz&index=45)       |
| 50~59강      | 🍽️      | [링크](https://www.youtube.com/watch?v=AXkaUrJs-Ko&list=PL87tgIIryGsa5vdz6MsaOEF8PK-YqK3fz&index=35)       |
| 60~69강      | 🍽️      | [링크](https://www.youtube.com/watch?v=AXkaUrJs-Ko&list=PL87tgIIryGsa5vdz6MsaOEF8PK-YqK3fz&index=25)       |
| 70~79강      | 🍽️      | [링크](https://www.youtube.com/watch?v=AXkaUrJs-Ko&list=PL87tgIIryGsa5vdz6MsaOEF8PK-YqK3fz&index=15)       |
| 80~89강      | 🍽️      | [링크](https://www.youtube.com/watch?v=AXkaUrJs-Ko&list=PL87tgIIryGsa5vdz6MsaOEF8PK-YqK3fz&index=5)        |

<!-- 여기까진 그대로 둬 주세요-->

> **🧞‍♀️ 오늘의 스터디는 지니와 함께합니다.**


## 30. 계층
- 뷰에서 데이터를 'Drill Down'해 값을 세부적으로 찾을 때 유용한 방법
- 날짜 데이터가 있는 경우, 자동으로 계층이 생성된다.
![30_1](/img/4th_week_img/30_1.png)
```
년, 분기, 월이 계층구조로 이루어져 있다.
```
![30_2](/img/4th_week_img/30_2.png)
```
계층 구성하는 법
```
![30_3](/img/4th_week_img/30_3.png)
```
'국가/지역','시/도','지역','도시'를 계층으로 묶어 '위치'필드 구성
```

## 31. 집합
- 사용자가 직접 어떤 조건을 설정하고, 그 조건을 기반으로 데이터들을 구분하는 방법
![31_1](/img/4th_week_img/31_1.png)
```
집합 만드는 법
```
![31_2](/img/4th_week_img/31_2.png)
```
일반: 그룹 기능과 비슷하게 수동으로 데이터를 선택 
조건: 설정 조건에 충족되는 데이터를 묶어줌
상위: 테이블마다 상위/하위 N개 데이터를 묶어줌
```
![31_3](/img/4th_week_img/31_3.png)
```
'수익 기준 상위 기준' 집합 생성(차원으로 생성)
마크>색상으로 드래그&드롭하면 집합에 포함되는 행을 색으로 구분 가능
```
<!-- 집합의 정의 및 활용 방법에 대해 알게 된 점을 적어주세요. -->

## 32. 결합집합
- 기본적으로 집합을 만들 때는 하나의 조건만을 설정할 수 있지만, 결합집합을 사용하면 두 가지의 조건을 적용할 수 있다.
- 예) 매출이 5만원 이상이고, 수익이 10000 이상인 도시의 데이터: 두 개의 집합 필요
<div style="display: flex; justify-content: center; gap: 10px;">
    <img src="/img/4th_week_img/32_1.png" alt="Image 1" style="width: 480px; height: auto;">
    <img src="/img/4th_week_img/32_2.png" alt="Image 2" style="width: 480px; height: auto;">
</div>
```
집합 만들기
```

![32_3](/img/4th_week_img/32_3.png)
```
생성한 집합 우클릭>결합된 집합 만들기
문제에서 요구한 조건 잘 보고, 결합된 집합 형태 선택하기
```
![32_4](/img/4th_week_img/32_4.png)
```
결합조건으로 표현
```


## 33. 계산된 필드
- 데이터 원본에 있는 필드를 활용하여 새로운 필드를 만드는 기능
- 계산해야할 데이터가 추가로 필요한 경우에 만들어 사용
#### 만드는 방법
1. 데이터 패널을 통해 생성
![33_1](/img/4th_week_img/33_1.png)
2. 분석 탭을 활용해 생성
![33_2](/img/4th_week_img/33_2.png)
3. 사용하고자 하는 필드 위에 마우스 우클릭
![33_3](/img/4th_week_img/33_3.png)

- 함수 입력하기
![33_4](/img/4th_week_img/33_4.png)
```
'전체' 드롭다운 클릭하면, 카테고리별 함수 또한 확인 가능
```

- 필드 입력하기
1. 필드 드래그&드랍
2. 입력창에 필드 입력
![33_5](/img/4th_week_img/33_5.png)
```
# 필드 입력할 때는 []: 대괄호 사용
# 텍스트 입력할 때는 '': 작은 따옴표 사용
# 입력한 문자 값은 회색으로 변경됨
# 주석 입력할 때는 "//" 입력 후 작성
```
#### 실습
![33_6](/img/4th_week_img/33_6.png)
```
집계함수를 활용해 계산
```
![33_7](/img/4th_week_img/33_7.png)
```
숫자 형식 백분율로 변경
```
![33_8](/img/4th_week_img/33_8.png)
```
제품 이름별 수익률
```

## 34. 행수준계산
- 계산된 필드는 기본 계산, 테이블 계산, 그리고 LOD 표현식으로 구분할 수 있음
  - 기본 계산: 데이터 원본에 대한 행 수준 계산 또는 집계 계산
    - 행 수준 계산: 데이터의 각 레코드를 통해 계산
    - 집계 계산: 현재 뷰에서 보이는 기준으로 계산
  ```
  집계 계산으로 만든 '수익률'필드: SUM([수익])/SUM([매출])  # (전체 수익)/(전체 매출)
  행 수준 계산으로 만든 '수익률'필드: [수익]/[매출]  # 수익을 매출로 나눈 항목별 레코드를 다 합계
  ```

1. 고객 이름, 성 분리
![34_1](/img/4th_week_img/34_1.png)
```
고객 이름: SPLIT([고객 이름], ' ', 1)
고객 성: SPLIT([고객 이름], ' ', 2)
```

2. 수익성 계산
![34_2](/img/4th_week_img/34_2.png)
```
IF [수익] > 0 THEN '수익성 있음'
ELSEIF [수익] < 0 THEN '수익성 없음'
ELSE '손익 평형'
END
```

3. 주문 처리 일수 계산
![34_3](/img/4th_week_img/34_3.png)
```
DATEDIFF('day',[주문 날짜], [배송 날짜])
# YMD로 바꾸는 방법: 우클릭>불연속형 필드 중 더 보기>사용자 지정>연/월/일
# '주문 처리 일수'필드가 측정값일 때, 어떤 주문 ID 들이 여러 개의 제품 레코드를 가지고 있어서 계산된 필드에서 모두 합계해버린다.(예: 컴퓨터 3일, 마우스 3일 -> 6일)
-> '주문 처리 일수'필드를 차원으로 바꾸면 해결
```

<!-- 행수준 계산의 의미와 적용 방법을 적어주세요. -->

## 35. 집계계산
- 현재 뷰에서 보이는 **기준**으로 계산하는 방식
![35_1](/img/4th_week_img/35_1.png)
```
sum([매출]): 합계 매출 집계 계산
# 사용자가 집계 계산된 필드를 만들면 해당 필드에 "집계"를 나타내고, 집계 방법을 변경할 수가 없다.
```

1. 연도별 주문 건수
![35_2](/img/4th_week_img/35_2.png)
```
COUNTID([주문 Id])
```
<!-- 집계계산의 정의 및 활용 사례에 대해 알게 된 점을 적어주세요. -->

## 36. 테이블계산
- 데이터 원본에 대한 계산이 아닌, 뷰에 보이는 내용을 바탕으로 데이터를 계산

1. 각 월마다의 연도별 누적 매출
![36_1](/img/4th_week_img/36_1.png)
```
RUNNING_SUM(sum([매출]))
# 계산된 필드>테이블 계산에서 함수 고르기
```
- 계산 방향 변경 방법
  - 계산 방향은 기본적으로 테이블(옆으로)로 설정되어 있다.
    - 계산된 필드 마우스 우클릭>다음을 사용하여 계산에서 변경
    - 계산된 필드 마우스 우클릭>테이블 계산 편집옵션을 선택하여 변경

2. 현재 달과 전 월의 매출 차이
![36_2](/img/4th_week_img/36_2.png)
```
sum([매출])-LOOKUP(sum([매출]), -1)
```
<!-- 테이블 계산의 개념 및 사용 방법을 적어주세요. -->

## 37. 퀵테이블계산(1)
- 자주 쓰이는 테이블 계산 유형들을 모아둔 기능
- 필드 우클릭>퀵 테이블 계산

1. 누계: 집계한 값을 누적한 값으로 한 번 더 집계하는 계산 유형
    
    예) 분기별 누적 매출 차트&월별 매출 차트
    ![37_1](/img/4th_week_img/37_1.png)
    ```
    행 선반의 필드를 더블클릭하여 적용된 함수 확인 가능
    ```
2. 차이: 측정값이 기준 값과 어느 정도차이가 나는지 구하는 계산 유형

    예) 각 제품에 대한 연도별 매출 차이
    ![37_2](/img/4th_week_img/37_2.png)
    ```
    우클릭>기준 통해 기준값 설정 가능
    ```
3. 비율 차이: 측정값들 사이의 성장률 또는 % 차이를 표현

    예) 월별 수익 차이를 %로 표현
    ![37_3](/img/4th_week_img/37_3.png)

4. 구성비율: 전체에서 각 항목들의 비중을 확인할 때 활용

    예) 지역별 제품 매출 순위와 구성비율
    ![37_4](/img/4th_week_img/37_4.png)
    ```
    다음을 사용하여 계산>패널(아래로) 사용
    ```

5. 백분위수: 전체에서 각 멤버들의 백분위수 표현

    예) 매출이 많은 고객과 매출이 적은 고객 확인
    ![37_5](/img/4th_week_img/37_5.png)
    
<!-- 퀵테이블 계산의 원리 및 예제에 대해 알게 된 점을 적어주세요. -->

## 38. 퀵테이블계산(2)
1. 이동평균: 이전의 값부터 현재까지 값에 대한 평균을 낼 때 사용. 주식에서 많이 활용
    ![38_1](/img/4th_week_img/38_1.png)
    - 2개 분기 이동평균선

    ![38_2](/img/4th_week_img/38_2.png)

2. YTD(Year to Date) 총계: 특정 시점을 기준으로 해당 연도부터 그 시점까지의 총계. '연'보다 하위 레벨 필드인 '분기','월'이 있어야 사용 가능
    ![38_3](/img/4th_week_img/38_3.png)

3. 통합 성장률(Compound Growth Rate): 특정 기간 동안의 성장률을 나타내는 지표. 경제나 산업 등의 성장률을 계산할 때 주로 사용. 경제 성장률처럼 여러 기간의 성장률을 통합해 평균을 계산할 때 기하평균을 사용(단기 데이터의 경우 산술평균 사용하는 경우도 존재)
    ![38_4](/img/4th_week_img/38_4.png)

4. 전년 대비 성장률(Year Over Year Growth,YoY)
    ![38_5](/img/4th_week_img/38_5.png)

5. YTD 성장률(Year to Date Growth)
 성장률 안에는 총계가 숨어있다.(YTD 총계를 먼저 구한 후, YTD 성장률을 구함)
    ![38_6](/img/4th_week_img/38_6.png)

#### YoY 성장률=(올해 값-전년도 같은 시점의 값)/(전년도 같은 시점의 값)×100
#### YTD 성장률=(올해 1월 1일부터 현재 시점까지의 누적 값−전년 같은 기간 누적 값)/(전년 같은 기간 누적 값)×100
​
<!-- 이동평균, YTD 총계, 전년 대비 성장률, YTD 성장률 등 본 강의에서 알게 된 점을 적어주세요. -->

## 문제 1.

규석이는 이제껏 매출을 올리는 데에 힘썼었지만, 왠지 모르게 주머니에 들어오는 돈이 없어 속상합니다. 

그래서 매출이 상위 20곳에 속하지만, 수익률(%)이 마이너스인 시/도를 확인하려고 합니다.

> 수익률은 SUM([수익]) / SUM([매출])로 정의합니다.

어떤 집합을 만들었고, 어떤 결합을 하였는지를 중심으로 기술하고, 결과 자료를 첨부해주세요. 

(텍스트 표 형태이며, 색상으로 위 집합을 구분할 수 있게 만들어주세요.)

<!-- 아래 예시 이미지를 삭제하고, 직접 만든 시트 사진을 올려주세요. 시트의 이름은 본인 이름으로 기입해주세요-->

![Q1_1](/img/4th_week_img/Q1_1.png)
```
계산된 필드 '수익률' 만들기
```
<div style="display: flex; justify-content: center; gap: 10px;">
    <img src="/img/4th_week_img/Q1_2.png" alt="Image 1" style="width: 480px; height: auto;">
    <img src="/img/4th_week_img/Q1_3.png" alt="Image 2" style="width: 480px; height: auto;">
</div>
![Q1_4](/img/4th_week_img/Q1_4.png)

```
각 집합 만들기, 결합집합 만들기
```
![Q1_5](/img/4th_week_img/Q1_4.png)

- 한 눈에 보기 쉽게, 결합집합을 필터로 설정

## 문제 2.
선희는 주문 Id별로 주문에서 배송까지에 걸리는 날짜 일수가 궁금했습니다. 
그래서 주문 ID별로 주문에서 배송까지 걸리는 일자를 '배송까지 걸린 일수'라는 계산된 필드로 만들고, 이를 마크에 올린 후 확인해보았습니다. 
이때, 계산된 필드의 식은 'DATEDIFF' 함수를 이용하였습니다.

배송까지 걸린 일수 계산을 위한 DATEDIFF 함수 수식을 적어주세요.

```
DATEDIFF('day',[주문 날짜],[배송 날짜])
```

![datediff](https://github.com/yousrchive/BUSINESS-INTELLIGENCE-TABLEAU/blob/main/study/img/4th%20til/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202024-09-30%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%203.47.21.png?raw=true)

그런데 위 그림처럼 '주문 날짜'와 '배송 날짜'를 함께 행에 올려 확인해보니, 주문날짜와 배송날짜의 차이가 '배송까지 걸린 일수'와 다릅니다.

ID-2021-11126을 보니, 11월 26일 배송에 11월 30일 배송이면 4일 차이인데, 12일이 걸렸다고 하네요. 왜 이런 문제가 생긴걸까요?

```
'주문 처리 일수'필드가 측정값일 때, 한 주문 ID 들이 여러 개의 제품 레코드를 가지고 있을 때, 모두 합계해버린다.(예: 컴퓨터 3일, 마우스 3일 -> 6일)
```

그리고 이를 해결하기 위해서는 어떻게 해야 할까요?

```
'주문 처리 일수'필드를 차원으로 바꾸면 해결된다.
```
![Q2_1](/img/4th_week_img/Q2_1.png)


## 문제 3.

다음은 Tableau의 다양한 계산을 사용할 수 있는 경우를 빈칸으로 두고 문제를 작성한 것입니다. 각 빈칸에 적합한 계산 유형을 채워보세요.

보기
> **누계, 차이, 비율 차이, 구성 비율, 순위, 백분위수, 이동 평균, YTD 총계, 통합 성장률, 전년 대비 성장률, YTD 성장률**

| 계산 유형               | 설명                                                                 | 사용 예시                                                                                          |
|-------------------------|----------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------|
| 누계           | 데이터의 누적 합계를 계산                                             | 한 기업이 월별 매출 데이터를 누적하여 연간 매출 추이를 보고 싶을 때 사용                                      |
| 차이            | 연속 데이터 포인트 간의 차이를 계산                                    | 한 기업이 월별 매출 데이터에서 전월 대비 매출 증감량을 분석하고 싶은 경우                                        |
| 비율 차이            | 연속 데이터 포인트 간의 비율 변화를 계산                               | 한 기업이 월별 매출 데이터에서 전월 대비 매출 증감률(%)을 분석하고 싶은 경우                                      |
| 구성 비율            | 전체에서 각 데이터 포인트의 비율을 계산                                | 한 기업이 전체 매출에서 각 제품군이 차지하는 비율을 보고 싶을 때 사용                                           |
| 순위            | 데이터의 순위를 매깁니다                                              | 한 기업이 제품별 매출 데이터를 순위별로 정렬하여 상위 10개 제품을 분석하고 싶은 경우                              |
| 백분위수            | 데이터의 백분위를 계산                                               | 한 기업이 고객별 구매 금액 데이터를 백분위수로 나누어 상위 25% 고객을 분석하고 싶은 경우                          |
| 이동평균            | 일정 기간의 평균을 계산                                               | 한 기업이 주간 매출 데이터에서 4주 이동 평균을 계산하여 트렌드를 분석하고 싶은 경우                              |
| YTD 총계            | 연초부터 현재까지의 총계를 계산                                      | 한 기업이 월별 매출 데이터를 연초부터 현재까지 누적하여 연간 매출 목표 달성 여부를 분석하고 싶은 경우             |
| 통합 성장률            | 일정 기간 동안의 연평균 성장률을 계산                                  | 한 기업이 5년 간 매출 데이터를 바탕으로 연평균 성장률(CAGR)을 계산하고 싶은 경우                                  |
| YoY 성장률            | 전년 동기간 대비 성장률을 계산                                        | 한 기업이 월별 매출 데이터에서 전년 동월 대비 매출 성장률을 분석하고 싶은 경우                                    |
| YTD 성장률            | 연초부터 현재까지의 성장률을 계산                                     | 한 기업이 올해 연초부터 현재까지의 매출이 전년 동기 대비 얼마나 성장했는지 분석하고 싶은 경우                     |

> 사용 예시를 참고하여 실제 경우처럼 생각하며 고민해보아요!